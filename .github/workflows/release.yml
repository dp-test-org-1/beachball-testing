name: Generate Production Release Notes

# Trigger only on tags without pre-release identifiers (no '-' in tag)
on:
  push:
    tags:
      - 'v*.*.*' # matches semantic version tags like v1.2.3 and not v1.2.3-beta

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup GitHub CLI
        uses: actions/setup-gh@v2

      # Generate Release Notes using the GitHub CLI
      - name: Create Release with Notes
        run: |
          gh release create ${{ github.ref_name }} \
            --title "Release ${{ github.ref_name }}" \
            --notes "$(gh release view ${{ github.ref_name }} -q .body || echo 'Initial release notes')" \
            --draft=false